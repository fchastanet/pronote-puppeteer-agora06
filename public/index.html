<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Homework Metrics Dashboard</title>
  <script src='https://cdn.jsdelivr.net/npm/echarts@5.3.3/dist/echarts.min.js'></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/duration.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/relativeTime.js"></script>
  <script src="charts/_common.js?t=@timestamp@"></script>
  <script src="charts/completionRateChart.js?t=@timestamp@"></script>
  <script src="charts/onTimeCompletionRateChart.js?t=@timestamp@"></script>
  <script src="charts/homeworkLoadChart.js?t=@timestamp@"></script>
  <script src="charts/homeworkLoadPerWeekDayChart.js?t=@timestamp@"></script>
  <script src="charts/subjectMetricsChart.js?t=@timestamp@"></script>
  <script src="charts/homeworksDurationChart.js?t=@timestamp@"></script>
  <script src='pushNotifications/publicVapidKey.js?t=@timestamp@'></script>
  <script src='pushNotifications/client.js?t=@timestamp@'></script>
  <link rel='stylesheet' href='css/style.css?t=@timestamp@'>
</head>
<body>
  <div class='navbar'>
    <a href='#'>Home</a>
    <a href='#'>Metrics</a>
    <a href='#'>Settings</a>
  </div>
  <div class='notification-container'>
    <div class='notification'></div>
    Push Notifications:
    <button id="subscribeButton" onclick='subscribeToPushNotifications()'>Subscribe</button>
    <button id="unsubscribeButton" onclick="unsubscribeFromPushNotifications()">Unsubscribe</button>
    <script>
      initSubscription();
    </script>
  </div>
  
  <h1>Homework Metrics Dashboard</h1>
  <div class='dashboard'>
    <div class='chart-container' id='completionRateChart'></div>
    <div class='chart-container' id='onTimeCompletionRateChart'></div>
    <div class='chart-container' id='homeworkLoadChart'></div>
    <div class='chart-container' id='homeworkLoadPerWeekDayChart'></div>
    <div class='chart-container' id='subjectMetricsChart'></div>
    <div class='chart-container' id='homeworksDurationChart'></div>
  </div>

  <script>
    initDayjs(dayjs);
    fetch('/metrics.json')
      .then(response => response.json())
      .then(data => {
        initCompletionRateChart(data);
        initOnTimeCompletionRateChart(data);
        initHomeworkLoadChart(data);
        initHomeworkLoadPerWeekDayChart(data);
        initSubjectMetricsChart(data);        
        initHomeworksDurationChart(data);
      });
  </script>
</body>
</html>